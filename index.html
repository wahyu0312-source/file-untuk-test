<!DOCTYPE html>
<html>
<head>
  <title>CORS Test</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
    #response { background-color: #f0f0f0; border: 1px solid #ccc; padding: 1em; margin-top: 1em; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>Apps Script CORS Connection Test</h1>
  <button id="testButton">Test POST Request</button>
  <pre id="response">Click the button to test...</pre>
  <script>
    // GANTI URL DI BAWAH INI DENGAN URL BARU DARI LANGKAH 2
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyFVJ-Oi2RMg5RmUsgJejpaCA8ZYtGeXSedhP4jpTzjlsIVwYq-6jThkNbKDb_nAfwS6g/exec";

    document.getElementById('testButton').addEventListener('click', () => {
      const responseEl = document.getElementById('response');
      responseEl.textContent = 'Sending request...';

      fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'cors',
        cache: 'no-cache',
        headers: {
          // Gunakan text/plain untuk menghindari "preflight request"
          'Content-Type': 'text/plain;charset=utf-8', 
        },
        body: JSON.stringify({ test: 'data' }) // Isi data tidak penting
      })
      .then(res => {
        if (!res.ok) {
          throw new Error('Network response was not ok. Status: ' + res.status);
        }
        return res.json();
      })
      .then(data => {
        responseEl.textContent = '✅ Success:\n\n' + JSON.stringify(data, null, 2);
      })
      .catch(err => {
        responseEl.textContent = '❌ Error:\n\n' + err.toString();
        console.error(err);
      });
    });
  </script>
</body>
</html>
